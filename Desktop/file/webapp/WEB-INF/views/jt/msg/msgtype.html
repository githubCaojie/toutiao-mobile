<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">

<head>
<title></title>
<template th:substituteby="framework/pageset.html"></template>
</head>
<body>
	<div id="app" view>
	<hy-filllayout rows="40,*" :showborder="false"  :showpadding="false"> 
			<hy-fillarea  >
		    	<div style="text-align:left">
					<hy-button text="保存" @click="save"></hy-button>	
				</div>
			</hy-fillarea>
			<hy-fillarea >
				<hy-form id="myform" name="dataWrap"
					label-position="left" :labelwidth="120"
					label-suffix="：" :cols="2" size="normal"> 
					<hy-formgroup title="基本信息">
						<hy-forminput label="消息名称" name="msgName" :rules="{ required: true}" ></hy-forminput>
						<hy-forminput label="服务名" name="serviceName" :maxlength="32"></hy-forminput>
						<hy-formselect label="发送方式" name="sendForm" v-model="sendFormData" multiple  dropname="JT.MSG_SEND_PATH" ></hy-formselect>
						<hy-formcustomer ></hy-formcustomer>
						<hy-forminput label="明细URL" name="detailUrl" :maxlength="64" :colspan="2" ></hy-forminput>
						<hy-forminput label="手机Url" name="mobileUrl" :maxlength="64" :colspan="2" ></hy-forminput>
						<hy-forminput label="列名1" name="colName1" :maxlength="64"></hy-forminput>
						<hy-forminput label="列名2" name="colName2" :maxlength="64"></hy-forminput>
						<hy-forminput label="列名3" name="colName3" :maxlength="64"></hy-forminput>
						<hy-forminput label="列名4" name="colName4" :maxlength="64"></hy-forminput>
						<hy-forminput label="列名5" name="colName5" :maxlength="64"></hy-forminput>
						<hy-forminput label="排序号" name="orderSn"></hy-forminput>
						<hy-forminput label="标题模板" name="titleTemplate"  :maxlength="128" type="textarea"  :rowspan="2" :colspan="2" ></hy-forminput>
						<hy-forminput label="消息模板" name="msgTemplate" :maxlength="128" type="textarea"  :rowspan="2" :colspan="2" ></hy-forminput>
						<hy-forminput label="备注" name="remark" :rowspan="2" :colspan="2" :maxlength="128" type="textarea"></hy-forminput>
					</hy-formgroup>
				</hy-form> 
		    </hy-fillarea>
		</hy-filllayout>
	</div>
	<script th:inline="javascript">
		var vm = new Vue({
			el : "#app",
			data : {
				sendFormData: null
			},
			mounted : function(){
				myform.setRecord(response.getAjaxDataWrap("dataWrap").getData()) ;
			},
			methods : {
				save : function(){
					myform.getRecord().set("sendForm",vm.sendFormData)
					myform.validate(function(data){
						if(data){
							var formData = myform.collectData();
							var dataArr = [];
							dataArr.push(formData);
							$.request({
								url : $$pageContextPath + 'jt/msg/msgType/save',
								data : dataArr,
								success : function(response){
									setRM(function(){$.close("true")});
								}
							});	
						}	
					});
				},
			}
		});
	</script>
</body>
</html>