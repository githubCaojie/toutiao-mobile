<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">

<head>
<title></title>
<template th:substituteby="framework/pageset.html"></template>
</head>
<body>
	<div id="app" view>
	
	<hy-filllayout rows="toolh,*" :showborder="true"  :showpadding="false"> 
			<hy-fillarea >
				<hy-button text="保存" @click="save"></hy-button>	
			</hy-fillarea>
			<hy-fillarea >
				<hy-form id="myform" name="dataWrap"
					labelposition="right" labelwidth="100" :readonly="false"  :cols="1" size="normal"> 
					<hy-formgroup title="详细信息">
						<hy-formdatepicker name="doTime" label="处理时间" type="datetime" ></hy-formdatepicker> 
						<hy-forminputbutton name="doMan" label="处理人员" @click="selectPerson" :colspan="1" v-model="partyId":rules="{ required: true}" labelprovider="com.haiyisoft.hr.per.labelprovider.PersonNameLabel" ></hy-forminputbutton> 
						<hy-formradio  dataprovider="UEP.YES_OR_NO" name="status" label="是否完成"  ></hy-formradio>
						<hy-forminput label="详细描述"  name="doDesc" :rowspan="2" :colspan="2" type="textarea"></hy-forminput>
					</hy-formgroup>
					<hy-formgroup title="相片">
						<div id="picFileId"></div>
					</hy-formgroup>
				</hy-form> 
		    </hy-fillarea>
		</hy-filllayout>
	</div>
	<script th:inline="javascript">
		var vm = new Vue({
			el : "#app",
			data : {
				partyId:""
			},
			mounted : function(){
				myform.setRecord(response.getAjaxDataWrap("dataWrap").getData()) ;
				cusUpload("picFileId",myform.getRecord().data.uuid,'',editFlag);
			},
			methods : {				
				selectPerson : function(){
					$.showModalDialog($$pageContextPath + "jt/right/selectPer/onePer", "选择人员", vm.selectBack1, null, 800, 460, 0);
				},
				selectBack1:function(data,b,c){
					this.partyId=data.partyId;
				},
				save : function(){
					myform.validate(function(data){
						if(data){
							var formData = myform.collectData();
							var dataArr = [];
							dataArr.push(formData);
							$.request({
								url : $$pageContextPath + 'jt/taskProc/save',
								data : dataArr,
								success : function(response){
									setRM(function(){$.close('')});
								}
							});		
						}	
					});
				}
			}
			
		});
	</script>
</body>
</html>